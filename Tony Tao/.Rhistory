labs(title = "Health Status",
x = "Healthy Level",
y = "Counts")
surgery %>%
filter(!is.na(bmi)) %>%
filter(!is.na(asa_status)) %>%
ggplot(aes(x=bmi))+
geom_density(fill = "lightblue", alpha = 0.4)+
facet_wrap(~asa_status, scales = "free_y")+
theme_linedraw()+
theme(plot.title = element_text(hjust = 0.5))+
labs(title = "Distribution of BMI by Asa_status",
x = "Healthy Level",
y = "Density")
surgery %>%
group_by(ahrq_ccs) %>%
summarize(mortality_rate = mean(ccsmort30rate)) %>%
arrange(-mortality_rate) %>%
slice_head(n=5)
surgery %>%
group_by(ahrq_ccs) %>%
summarize(complication_rate = mean(ccscomplicationrate)) %>%
arrange(-complication_rate) %>%
slice_head(n=5)
surgery %>%
ggplot(aes(x=ccsmort30rate))+
geom_density()+
facet_wrap(~ahrq_ccs, ncol = 5)+
theme_linedraw()+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 60))+
labs(title = "30-days Mortality Rate",
x = "Mortality Rate",
y = "Density")
surgery_1 <-  surgery%>%
mutate(mort = ifelse(mort30 == "Yes", 1, 0)) %>%
select(month, mort) %>%
group_by(month) %>%
summarise(mort = sum(mort))
surgery_2 <- surgery %>%
mutate(compli= ifelse(complication == "Yes", 1, 0)) %>%
select(month, compli) %>%
group_by(month) %>%
summarise(compli = sum(compli))
surgery_2
surgery_2 %>%
ggplot(aes(x=month, y=mort))+
geom_col()+
theme_linedraw()+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 60))+
labs(title = "Mortality",
x = "Mortality",
y = "Count")
surgery_1 %>%
ggplot(aes(x=month, y=mort))+
geom_col()+
theme_linedraw()+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 60))+
labs(title = "Mortality",
x = "Mortality",
y = "Count")
diabetes %>%
mutate(age_catatory = case_when(age <= 19 ~ "teenager",
age > 20 & age <= 39 ~ "young adult",
age > 40 & age <= 59 ~ "middle age",
age > 60 & age <= 79 ~ "senior",
age > 80 & age <= 100 ~ "super senior"),
)
``
diabetes %>%
mutate(age_catatory = case_when(age <= 19 ~ "teenager",
age > 20 & age <= 39 ~ "young adult",
age > 40 & age <= 59 ~ "middle age",
age > 60 & age <= 79 ~ "senior",
age > 80 & age <= 100 ~ "super senior"),
)
diabetes %>%
mutate(age_catatory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
filter()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age, y=diabetes_status))+
geom_col()+
facet_wrap(~age_catagory, n = 5)
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age, y=diabetes_status))+
geom_col()+
facet_wrap(~age_catagory)
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age, y=diabetes_status))+
geom_col()+
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age, y=diabetes_status))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age, y=diabetes_status))+
geom_col()+
facet_wrap(~age_catagory)
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age_catagory, y=diabetes_status))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=age_catagory, y=sum(diabetes_status)))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
ggplot(aes(x=reorder(age_catagory, diabetes_status), y=diabetes_status))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
count(age_catagory)
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n), fill = age_catagory)+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n), fill = age_catagory, color = age_catagory)+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
count(age_catagory)
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
filter(diabetes_status == 1)
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n))+
geom_col()
diabetes <- diabetes %>%
mutate(diabetes_status = ifelse(diabetes == "Diabetes", 1, 0))
diabetes_2019 <- diabetes_2019 %>%
mutate(diabetes_status = ifelse(diabetic == "yes", 1, 0))
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
filter(diabetes_status == 1)
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
filter(diabetes_status == 1)
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
filter(diabetes_status == 1) %>%
count(age_catagory) %>%
ggplot(aes(x=reorder(age_catagory, n), y=n))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
summarise(diabetic = sum(diabetes_status)) %>%
ggplot(aes(x=reorder(age_catagory, diabetic), y=diabetic))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
summarise(diabetic = sum(diabetes_status)) %>%
ggplot(aes(x=reorder(age_catagory, diabetic), y=diabetic))+
geom_col()
diabetes%>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
summarise(diabetic = sum(diabetes_status)) %>%
ggplot(aes(x=reorder(age_catagory, diabetic), y=diabetic))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
summarise(diabetic = sum(diabetes_status)) %>%
ggplot(aes(x=reorder(age_catagory, diabetic), y=diabetic))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
summarise(diabetic = sum(diabetes_status))
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
group_by(age_catagory)
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
group_by(age_catagory) %>%
summarise(diabetic = sum(diabetes_status)) %>%
ggplot(aes(x=reorder(age_catagory, diabetic), y=diabetic))+
geom_col()
diabetes %>%
mutate(age_catagory = case_when(age <= 19 ~ "teenager",
age >= 20 & age <= 39 ~ "young adult",
age >= 40 & age <= 59 ~ "middle age",
age >= 60 & age <= 79 ~ "senior",
age >= 80 & age <= 100 ~ "super senior"),
) %>%
group_by(age_catagory) %>%
summarise(diabetic = sum(diabetes_status)) %>%
ggplot(aes(x=reorder(age_catagory, diabetic), y=diabetic, fill = age_catagory))+
geom_col()
View(heart_failture)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(naniar)
library(shiny)
library(shinydashboard)
getwd()
diabetes_2019 <- read_csv("Group Project Data/diabetes_dataset__2019.csv") %>% clean_names()
heart_failture <- read_csv("Group Project Data/heart_failure_clinical_records_dataset.csv") %>% clean_names()
any_na(diabetes_2019)
any_na(heart_failture)
naniar::miss_var_summary(diabetes_2019)
naniar::miss_var_summary(heart_failture)
diabetes_2019_tidy <- diabetes_2019 %>%
mutate(high_bp_status = ifelse(high_bp == "yes", 1, 0)) %>%
mutate(family_heredity = ifelse(family_diabetes == "yes", 1, 0)) %>%
mutate(diabetic_status = ifelse(diabetic == "yes", 1, 0))
heart_failture_tidy <- heart_failture %>%
mutate(smoking_status = ifelse(smoking == 1, "yes", "no")) %>%
mutate(high_bp_status = ifelse(high_blood_pressure == 1, "yes", "no"))
diabetes_2019_tidy %>%
filter(diabetic_status != "NA") %>%
count(diabetic_status, high_bp) %>%
pivot_wider(names_from = diabetic_status,
names_prefix = "diabetic_",
values_from = n) %>%
mutate(diabetic_per = diabetic_1/(diabetic_1+diabetic_0)) %>%
ggplot(aes(x=high_bp, y=diabetic_per, fill = high_bp, label=sprintf("%0.2f", round(diabetic_per, digits = 2))))+
geom_col(alpha = 0.6)+
scale_fill_discrete(labels=c("No", "Yes"))+
geom_text(vjust = -0.3, color = "deepskyblue4")+
theme_linedraw()+
labs(title = "High bp vs. Diabetic",
x = NULL,
y = "Diabetic Perentage")+
guides(fill = guide_legend(title = "High bp"))+
theme(plot.title = element_text(hjust = 0.5))
heart_failture_tidy %>%
filter(diabetes != "NA") %>%
count(diabetes, high_bp_status) %>%
pivot_wider(names_from = diabetes,
names_prefix = "diabetic_",
values_from = n) %>%
mutate(diabetic_per = diabetic_1/(diabetic_1+diabetic_0)) %>%
ggplot(aes(x=high_bp_status, y=diabetic_per, fill = high_bp_status, label=sprintf("%0.2f", round(diabetic_per, digits = 2))))+
geom_col(alpha = 0.6)+
scale_fill_discrete(labels=c("No", "Yes"))+
geom_text(vjust = -0.3, color = "deepskyblue4")+
theme_linedraw()+
labs(title = "High bp vs. Diabetic",
x = NULL,
y = "Diabetic Perentage")+
guides(fill = guide_legend(title = "High bp"))+
theme(plot.title = element_text(hjust = 0.5))
diabetes_2019_tidy %>%
filter(diabetic_status != "NA") %>%
count(diabetic_status, smoking) %>%
pivot_wider(names_from = diabetic_status,
names_prefix = "diabetic_",
values_from = n) %>%
mutate(diabetic_per = diabetic_1/(diabetic_1+diabetic_0)) %>%
ggplot(aes(x=smoking, y=diabetic_per, fill = smoking, label=sprintf("%0.2f", round(diabetic_per, digits = 2))))+
geom_col(alpha = 0.6)+
scale_fill_discrete(labels=c("No", "Yes"))+
geom_text(vjust = -0.3, color = "deepskyblue4")+
theme_linedraw()+
labs(title = "Smoking vs. Diabetic",
x = NULL,
y = "Diabetic Perentage")+
guides(fill = guide_legend(title = "Smoking"))+
theme(plot.title = element_text(hjust = 0.5))
heart_failture_tidy %>%
filter(diabetes != "NA") %>%
count(diabetes, smoking_status) %>%
pivot_wider(names_from = diabetes,
names_prefix = "diabetic_",
values_from = n) %>%
mutate(diabetic_per = diabetic_1/(diabetic_1+diabetic_0)) %>%
ggplot(aes(x=smoking_status, y=diabetic_per, fill = smoking_status, label=sprintf("%0.2f", round(diabetic_per, digits = 2))))+
geom_col(alpha = 0.6)+
scale_fill_discrete(labels=c("No", "Yes"))+
geom_text(vjust = -0.3, color = "deepskyblue4")+
theme_linedraw()+
labs(title = "Smoking vs. Diabetic",
x = NULL,
y = "Diabetic Perentage")+
guides(fill = guide_legend(title = "Smoking"))+
theme(plot.title = element_text(hjust = 0.5))
diabetes_2019_tidy %>%
filter(physically_active != "NA") %>%
filter(diabetic_status != "NA") %>%
group_by(physically_active) %>%
summarize(diabetic = sum(diabetic_status)) %>%
ggplot(aes(x=physically_active, y=diabetic, fill = physically_active))+
geom_col(alpha = 0.6)+
scale_x_discrete(limits = c("none", "less than half an hr", "more than half an hr", "one hr or more"))+
geom_text(aes(label=diabetic, vjust = -0.2), color = "deepskyblue4")+
theme_linedraw()+
labs(title = "Physically Active vs. Diabetic",
x = "Physically Active",
y = "Diabetic")+
theme(plot.title = element_text(hjust = 0.5))
diabetes_2019_tidy %>%
filter(diabetic_status!="NA") %>%
mutate(diabetic_status=as_factor(diabetic_status)) %>%
ggplot(aes(x=bmi, fill=diabetic_status))+
geom_density(alpha=0.6)+
theme_linedraw()+
scale_fill_discrete(labels=c("No", "Yes"))+
labs(title = "Bmi vs. Diabetic",
x = "Bmi",
y = NULL)+
guides(fill = guide_legend(title = "Diabetes"))+
theme(plot.title = element_text(hjust = 0.5))
diabetes_2019_tidy %>%
filter(diabetic != "NA") %>%
ggplot(aes(x=diabetic, y=bmi, fill = diabetic))+
geom_boxplot(alpha = 0.6)+
theme_linedraw()+
scale_fill_discrete(labels=c("No", "Yes"))+
labs(title = "Bmi vs. Diabetic",
x = NULL,
y = NULL)+
guides(fill = guide_legend(title = "Diabetes"))+
theme(plot.title = element_text(hjust = 0.5))
library(usmap)
here()
map_data_2004 <- read_csv(here("Tony Tao", "Group Project Data", "DiabetesAtlas_CountyData2004.csv"), skip = 2, na = "No Data")
map_data_2008 <- read_csv(here("Tony Tao", "Group Project Data", "DiabetesAtlas_CountyData2008.csv"), skip = 2, na = "No Data")
map_data_2012 <- read_csv(here("Tony Tao", "Group Project Data", "DiabetesAtlas_CountyData2012.csv"), skip = 2, na = "No Data")
map_data_2016 <- read_csv(here("Tony Tao", "Group Project Data", "DiabetesAtlas_CountyData2016.csv"), skip = 2, na = "No Data")
map_data_2020 <- read_csv(here("Tony Tao", "Group Project Data", "DiabetesAtlas_CountyData2020.csv"), skip = 2, na = "No Data")
glimpse(map_data_2004)
map_data_2004$CountyFIPS <- as.numeric(map_data_2004$CountyFIPS)
map_data_focused_2004 <- map_data_2004 %>%
select(CountyFIPS, Percentage) %>%
rename(fips = CountyFIPS, values = Percentage)
summary(map_data_focused_2004$values)
plot_usmap(data = map_data_focused_2004)+
scale_fill_gradient2(low = "deepskyblue3", mid = "white", high = "red", name = "Diabetes Percentage", midpoint = 8)
map_data_2008$CountyFIPS <- as.numeric(map_data_2008$CountyFIPS)
map_data_focused_2008 <- map_data_2008 %>%
select(CountyFIPS, Percentage) %>%
rename(fips = CountyFIPS, values = Percentage)
summary(map_data_focused_2008$values)
plot_usmap(data = map_data_focused_2004)+
scale_fill_gradient2(low = "deepskyblue3", mid = "white", high = "red", name = "Diabetes Percentage", midpoint = 8)
map_data_2012$CountyFIPS <- as.numeric(map_data_2012$CountyFIPS)
map_data_focused_2012 <- map_data_2012 %>%
select(CountyFIPS, Percentage) %>%
rename(fips = CountyFIPS, values = Percentage)
summary(map_data_focused_2012$values)
plot_usmap(data = map_data_focused_2012)+
scale_fill_gradient2(low = "deepskyblue3", mid = "white", high = "red", name = "Diabetes Percentage", midpoint = 8)
map_data_2016$CountyFIPS <- as.numeric(map_data_2016$CountyFIPS)
map_data_focused_2016 <- map_data_2016 %>%
select(CountyFIPS, Percentage) %>%
rename(fips = CountyFIPS, values = Percentage)
summary(map_data_focused_2016$values)
plot_usmap(data = map_data_focused_2016)+
scale_fill_gradient2(low = "deepskyblue3", mid = "white", high = "red", name = "Diabetes Percentage", midpoint = 8)
map_data_2020$CountyFIPS <- as.numeric(map_data_2020$CountyFIPS)
map_data_focused_2020 <- map_data_2020 %>%
select(CountyFIPS, Percentage) %>%
rename(fips = CountyFIPS, values = Percentage)
summary(map_data_focused_2020$values)
plot_usmap(data = map_data_focused_2020)+
scale_fill_gradient2(low = "deepskyblue3", mid = "white", high = "red", name = "Diabetes Percentage", midpoint = 8)
